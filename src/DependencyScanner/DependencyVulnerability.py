import json
import logging

class DependencyVulnerability(object):
    """
    DependencyVulnerability class contains all information for a vulnerability of a thrid party libary.
    """

    def __init__(self, dependencyName: str, dependencyVersion: str, id: str, displayName: str, title: str, description: str, cvssScore: int, cvssVector: str, cwe: str, cve: str,  reference: str, externalReferences: list[str]):
        self.dependencyName: str             = dependencyName
        self.dependencyVersion: str          = dependencyVersion
        self.id: str                         = id
        self.displayName: str                = displayName
        self.title: str                      = title
        self.description: str                = description
        self.cvssScore: int                  = cvssScore
        self.cvssVector: str                 = cvssVector
        self.cwe: str                        = cwe
        self.cve: str                        = cve
        self.reference: str                  = reference
        self.externalReferences: list[str]   = externalReferences          
        logging.debug("DependencyVulnerability " + json.dumps(self.__dict__, indent=2)) 


    def __eq__(self, other):
        if not isinstance(other, DependencyVulnerability):
            return False
        return (self.dependencyName == other.dependencyName and
                self.dependencyVersion == other.dependencyVersion and
                self.id == other.id and
                self.displayName == other.displayName and
                self.title == other.title and
                self.description == other.description and
                self.cvssScore == other.cvssScore and
                self.cvssVector == other.cvssVector and
                self.cwe == other.cwe and
                self.cve == other.cve and
                self.reference == other.reference and
                self.externalReferences == other.externalReferences)