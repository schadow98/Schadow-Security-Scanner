import json
import logging

class DependencyVulnerability(object):
    """
    DependencyVulnerability class contains all information for a vulnerability of a thrid party libary.
    """

    def __init__(self, dependencyName: str, dependencyVersion: str, id: str, displayName: str, title: str, description: str, cvssScore: int, cvssVector: str, cwe: str, cve: str,  reference: str, externalReferences: list[str]):
        self.dependencyName = dependencyName
        self.dependencyVersion = dependencyVersion
        self.id = id
        self.displayName = displayName
        self.title = title
        self.description = description
        self.cvssScore = cvssScore
        self.cvssVector = cvssVector
        self.cwe = cwe
        self.cve = cve
        self.reference = reference
        self.externalReferences = externalReferences          
        logging.debug("DependencyVulnerability " + json.dumps(self.__dict__, indent=2)) 


    def __eq__(self, other):
        if not isinstance(other, DependencyVulnerability):
            return False
        return (self.dependencyName == other.dependencyName and
                self.dependencyVersion == other.dependencyVersion and
                self.id == other.id and
                self.displayName == other.displayName and
                self.title == other.title and
                self.description == other.description and
                self.cvssScore == other.cvssScore and
                self.cvssVector == other.cvssVector and
                self.cwe == other.cwe and
                self.cve == other.cve and
                self.reference == other.reference and
                self.externalReferences == other.externalReferences)